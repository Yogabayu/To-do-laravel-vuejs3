import{m as _}from"./VAvatar-c949dc11.js";import{O as U,P as L,Q as N,R as M,S as R,T as j,U as A,W as E,X as G,a as e,Y as H,o as m,c,w as a,b as o,i as g,e as h,t as d,f as y,G as k,F,d as C,V as T,D as K,M as O,H as z,I as J}from"./main-a0f635ce.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";import{V as w,a as W,c as b,b as X}from"./VCard-6c0ec275.js";import{d as Y,V as $,a as q,b as S,c as x}from"./VMenu-10fdde58.js";import{a as Z,V as ee}from"./VChip-c2c4b442.js";import{V as D}from"./VSpacer-494c86f5.js";import{V as I}from"./VForm-12a536ad.js";import{V as v,a as V}from"./VRow-dcc804f1.js";import{V as P}from"./VTextarea-264496ab.js";import{V as te}from"./VDialog-59cdd517.js";import"./VImg-ce066be5.js";import"./index-5b9673f5.js";import"./VOverlay-98a581b7.js";import"./dialog-transition-762e9cc7.js";/* empty css              */import"./VInput-872f54a1.js";const se=U({fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...L(),...N(),...M(),...R()},"VTable"),ae=j()({name:"VTable",props:se(),setup(t,s){let{slots:r,emit:B}=s;const{themeClasses:l}=A(t),{densityClasses:u}=E(t);return G(()=>e(t.tag,{class:["v-table",{"v-table--fixed-height":!!t.height,"v-table--fixed-header":t.fixedHeader,"v-table--fixed-footer":t.fixedFooter,"v-table--has-top":!!r.top,"v-table--has-bottom":!!r.bottom,"v-table--hover":t.hover},l.value,u.value,t.class],style:t.style},{default:()=>{var i,p,f;return[(i=r.top)==null?void 0:i.call(r),r.default?e("div",{class:"v-table__wrapper",style:{height:H(t.height)}},[e("table",null,[r.default()])]):(p=r.wrapper)==null?void 0:p.call(r),(f=r.bottom)==null?void 0:f.call(r)]}})),{}}}),oe={data(){return{detail:{},fileId:this.$route.params.fileId,fileUser:this.$userPhotoUrl,filePath:this.$filePath,comments:null,dataForm:{id:null,file_uuid:this.$route.params.fileId,desc:null,descupdate:null},edit:!1}},methods:{goBack(){this.$router.go(-1)},formatDate(t){return new Date(t).toLocaleDateString("id-ID")},async getDetailFile(t){try{const s=await _.get(`/file/${t}`);s.status===200?this.detail=s.data.data:this.$showToast("error","Sorry",s.data.data.message)}catch(s){this.$showToast("error","Sorry",s.response.data.data.message)}},resetForm(){this.dataForm={id:null,file_uuid:this.$route.params.fileId,desc:null,descupdate:null}},async getCommentFile(t){try{const s=await _.get(`/comment/${t}`);this.comments=s.data.data.map(r=>({id:r.uuid,content:r.desc,user_type:r.user.isAdmin,name:r.user.name,position:r.user.position.name,created_at:r.created_at}))}catch(s){const r=s.response&&s.response.data&&s.response.data.message?s.response.data.message:"Gagal login. Silakan coba lagi.";this.$showToast("error","Sorry",r)}},async insertCommentar(){try{this.dataForm.desc===null&&this.$showToast("error","Sorry","komentar kosong");const t=new FormData;t.append("file_uuid",this.dataForm.file_uuid),t.append("desc",this.dataForm.desc),t.append("_method","POST");const s=await _.post("/comment",t);s.status===200?(this.resetForm(),this.getCommentFile(this.fileId),this.$showToast("success","Success",s.data.message)):this.$showToast("error","Sorry",s.data.message)}catch(t){this.$showToast("error","Sorry",t.response.data.message)}},async deleteComment(t){try{if(!window.confirm("Apakah Anda yakin ingin menghapus comment?"))return;const r=await _.delete(`/comment/${t}`);r.status===200?(this.getCommentFile(this.fileId),this.$showToast("success","Berhasil",r.data.message)):this.$showToast("error","Sorry",r.data.message)}catch(s){this.$showToast("error","Sorry",s.response.data.message)}},popupEdit(t){this.dataForm.id=t.id,this.dataForm.descupdate=t.content,this.edit=!0},async updateComment(){try{const t=new FormData;t.append("desc",this.dataForm.descupdate),t.append("_method","PUT");const s=await _.post(`/comment/${this.dataForm.id}`,t);s.status===200?(this.resetForm(),this.getCommentFile(this.fileId),this.edit=!1,this.$showToast("success","Success",s.data.message)):this.$showToast("error","Sorry",s.data.message)}catch(t){this.$showToast("error","Sorry",t.response.data.message)}}},mounted(){this.getDetailFile(this.fileId),this.getCommentFile(this.fileId)}},n=t=>(z("data-v-9689b9dd"),t=t(),J(),t),re=n(()=>o("td",null,"Nama File",-1)),le=n(()=>o("td",null,":",-1)),ie=n(()=>o("td",null,"Deskripsi Singkat",-1)),de=n(()=>o("td",null,":",-1)),ne=n(()=>o("td",null,"Keyword",-1)),ue=n(()=>o("td",null,":",-1)),me={key:0},ce=n(()=>o("td",null,"Pengunggah",-1)),he=n(()=>o("td",null,":",-1)),pe={class:"row d-flex align-center"},fe={key:0,class:"player-wrapper"},_e=["src","alt"],ge={key:1},ye={key:1},Ve=n(()=>o("td",null,"Jabatan",-1)),we=n(()=>o("td",null,":",-1)),be={class:"row d-flex align-center"},ve=["src"],ke={class:"mt-3"},Fe={class:"comment-content"};function Ce(t,s,r,B,l,u){return m(),c("div",null,[e(w,{class:"auth-card pa-4 pt-5"},{default:a(()=>[e(W,{class:"align-left"},{default:a(()=>[o("span",{color:"primary",onClick:s[0]||(s[0]=(...i)=>u.goBack&&u.goBack(...i)),style:{cursor:"pointer"}},[e(g,{icon:"bx-arrow-back",color:"primary",tag:"back",start:""}),h(" Back ")]),e(b,{class:"text-2xl font-weight-bold"},{default:a(()=>[h(" Detail "+d(l.detail.name??"-"),1)]),_:1}),e(Y,{inset:""}),e(ae,null,{default:a(()=>[o("tbody",null,[o("tr",null,[re,le,o("td",null,d(l.detail.name),1)]),o("tr",null,[ie,de,o("td",null,d(l.detail.summary),1)]),o("tr",null,[ne,ue,o("td",null,d(l.detail.keywords),1)]),l.detail.author?(m(),c("tr",me,[ce,he,o("td",null,[o("div",pe,[l.detail.author.photo?(m(),c("div",fe,[o("img",{class:"avator",src:l.fileUser+l.detail.author.photo,alt:l.detail.name,width:60},null,8,_e)])):y("",!0),l.detail.author.name?(m(),c("span",ge,d(l.detail.author.name),1)):y("",!0)])])])):y("",!0),l.detail.positions?(m(),c("tr",ye,[Ve,we,o("td",null,[o("div",be,[e(Z,{"selected-class":"text-primary",column:""},{default:a(()=>[(m(!0),c(k,null,F(l.detail.positions,(i,p)=>(m(),c("div",{key:p},[e(ee,{style:{color:"rgb(6, 84, 107)"}},{default:a(()=>[h(d(i.name),1)]),_:2},1024)]))),128))]),_:1})])])])):y("",!0)])]),_:1}),o("div",null,[o("iframe",{width:"100%",height:"500px",src:l.filePath+l.detail.path,frameborder:"0",allowfullscreen:""},null,8,ve)]),e(D),o("div",ke,[e(w,{class:"mx-auto"},{default:a(()=>[e(b,null,{default:a(()=>[h(" Komentar ")]),_:1}),e(b,null,{default:a(()=>[e(I,{onSubmit:C(u.insertCommentar,["prevent"])},{default:a(()=>[e(v,{align:"center",justify:"center"},{default:a(()=>[e(V,{md:"10",cols:"10"},{default:a(()=>[e(P,{"bg-color":"grey-lighten-2",color:"cyan",modelValue:l.dataForm.desc,"onUpdate:modelValue":s[1]||(s[1]=i=>l.dataForm.desc=i)},null,8,["modelValue"])]),_:1}),e(V,{md:"2",cols:"2"},{default:a(()=>[e(T,{density:"compact",icon:"mdi-note-plus",type:"submit"})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(D),e(X,null,{default:a(()=>[o("div",null,[o("div",null,[(m(!0),c(k,null,F(l.comments,(i,p)=>(m(),c("div",{key:p,class:K({"admin-comment":i.user_type==1,"user-comment":i.user_type==0})},[o("div",Fe,[o("p",null,'" '+d(i.content)+' "',1),e(v,{class:"justify-space-between mx-2 mb-2"},{default:a(()=>[o("small",null,d(i.name)+" - "+d(i.position),1),o("small",null,d(u.formatDate(i.created_at)),1)]),_:2},1024)]),e($,{transition:"scale-transition"},{activator:a(({props:f})=>[e(g,O(f,{class:"ellipsis-icon"}),{default:a(()=>[h("mdi-dots-vertical")]),_:2},1040)]),default:a(()=>[e(q,null,{default:a(()=>[e(S,{color:"primary",onClick:f=>u.popupEdit(i)},{prepend:a(()=>[e(g,{icon:"mdi-edit"})]),default:a(()=>[e(x,null,{default:a(()=>[h(" edit")]),_:1})]),_:2},1032,["onClick"]),e(S,{color:"primary",onClick:f=>u.deleteComment(i.id)},{prepend:a(()=>[e(g,{icon:"mdi-trash"})]),default:a(()=>[e(x,null,{default:a(()=>[h(" hapus")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)],2))),128))])])]),_:1}),e(te,{modelValue:l.edit,"onUpdate:modelValue":s[3]||(s[3]=i=>l.edit=i),width:"auto"},{default:a(()=>[e(w,null,{title:a(()=>[h(" Update comment ")]),text:a(()=>[e(I,{onSubmit:C(u.updateComment,["prevent"])},{default:a(()=>[e(v,{align:"center",justify:"center"},{default:a(()=>[e(V,{md:"10",cols:"10"},{default:a(()=>[e(P,{"bg-color":"grey-lighten-2",color:"cyan",modelValue:l.dataForm.descupdate,"onUpdate:modelValue":s[2]||(s[2]=i=>l.dataForm.descupdate=i)},null,8,["modelValue"])]),_:1}),e(V,{md:"2",cols:"2"},{default:a(()=>[e(T,{density:"compact",icon:"mdi-note-plus",type:"submit"})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),_:1})]),_:1})])}const Ke=Q(oe,[["render",Ce],["__scopeId","data-v-9689b9dd"]]);export{Ke as default};
